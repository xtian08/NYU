
<#
Script Name: NACProfiles.ps1
v1 : Converted Landesk Batch Script to Powershell for GPO Push
Description: Inject NAC Profiles 
Author: christian.mariano@hcl.com
#>

#Enable Wired/Wlan Services
'WlanSvc','dot3svc' | Start-Service

#Clear Network Profiles
netsh lan delete profile i=*

#generate lan profile - lan.xml
if (Test-Path "C:\Temp") {}
else {mkdir C:\Temp}

if (Test-Path "c:\Temp\lan.xml"){}
else {
    New-Item -ItemType File -Name "lan.xml" -Path "c:\temp"
     $EncodedText = "PAA/AHgAbQBsACAAdgBlAHIAcwBpAG8AbgA9ACIAMQAuADAAIgA/AD4ACgA8AEwAQQBOAFAAcgBvAGYAaQBsAGUAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AbgBlAHQAdwBvAHIAawBpAG4AZwAvAEwAQQBOAC8AcAByAG8AZgBpAGwAZQAvAHYAMQAiAD4ACgAJADwATQBTAE0APgAKAAkACQA8AHMAZQBjAHUAcgBpAHQAeQA+AAoACQAJAAkAPABPAG4AZQBYAEUAbgBmAG8AcgBjAGUAZAA+AGYAYQBsAHMAZQA8AC8ATwBuAGUAWABFAG4AZgBvAHIAYwBlAGQAPgAKAAkACQAJADwATwBuAGUAWABFAG4AYQBiAGwAZQBkAD4AdAByAHUAZQA8AC8ATwBuAGUAWABFAG4AYQBiAGwAZQBkAD4ACgAJAAkACQA8AE8AbgBlAFgAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AbgBlAHQAdwBvAHIAawBpAG4AZwAvAE8AbgBlAFgALwB2ADEAIgA+AAoACQAJAAkACQA8AGMAYQBjAGgAZQBVAHMAZQByAEQAYQB0AGEAPgB0AHIAdQBlADwALwBjAGEAYwBoAGUAVQBzAGUAcgBEAGEAdABhAD4ACgAJAAkACQAJADwAYQB1AHQAaABNAG8AZABlAD4AbQBhAGMAaABpAG4AZQBPAHIAVQBzAGUAcgA8AC8AYQB1AHQAaABNAG8AZABlAD4ACgAJAAkACQAJADwARQBBAFAAQwBvAG4AZgBpAGcAPgA8AEUAYQBwAEgAbwBzAHQAQwBvAG4AZgBpAGcAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AcAByAG8AdgBpAHMAaQBvAG4AaQBuAGcALwBFAGEAcABIAG8AcwB0AEMAbwBuAGYAaQBnACIAPgA8AEUAYQBwAE0AZQB0AGgAbwBkAD4APABUAHkAcABlACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHcAdwB3AC4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQAvAHAAcgBvAHYAaQBzAGkAbwBuAGkAbgBnAC8ARQBhAHAAQwBvAG0AbQBvAG4AIgA+ADIANQA8AC8AVAB5AHAAZQA+ADwAVgBlAG4AZABvAHIASQBkACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHcAdwB3AC4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQAvAHAAcgBvAHYAaQBzAGkAbwBuAGkAbgBnAC8ARQBhAHAAQwBvAG0AbQBvAG4AIgA+ADAAPAAvAFYAZQBuAGQAbwByAEkAZAA+ADwAVgBlAG4AZABvAHIAVAB5AHAAZQAgAHgAbQBsAG4AcwA9ACIAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAG0AaQBjAHIAbwBzAG8AZgB0AC4AYwBvAG0ALwBwAHIAbwB2AGkAcwBpAG8AbgBpAG4AZwAvAEUAYQBwAEMAbwBtAG0AbwBuACIAPgAwADwALwBWAGUAbgBkAG8AcgBUAHkAcABlAD4APABBAHUAdABoAG8AcgBJAGQAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AcAByAG8AdgBpAHMAaQBvAG4AaQBuAGcALwBFAGEAcABDAG8AbQBtAG8AbgAiAD4AMAA8AC8AQQB1AHQAaABvAHIASQBkAD4APAAvAEUAYQBwAE0AZQB0AGgAbwBkAD4APABDAG8AbgBmAGkAZwAgAHgAbQBsAG4AcwA9ACIAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAG0AaQBjAHIAbwBzAG8AZgB0AC4AYwBvAG0ALwBwAHIAbwB2AGkAcwBpAG8AbgBpAG4AZwAvAEUAYQBwAEgAbwBzAHQAQwBvAG4AZgBpAGcAIgA+ADwARQBhAHAAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AcAByAG8AdgBpAHMAaQBvAG4AaQBuAGcALwBCAGEAcwBlAEUAYQBwAEMAbwBuAG4AZQBjAHQAaQBvAG4AUAByAG8AcABlAHIAdABpAGUAcwBWADEAIgA+ADwAVAB5AHAAZQA+ADIANQA8AC8AVAB5AHAAZQA+ADwARQBhAHAAVAB5AHAAZQAgAHgAbQBsAG4AcwA9ACIAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAG0AaQBjAHIAbwBzAG8AZgB0AC4AYwBvAG0ALwBwAHIAbwB2AGkAcwBpAG8AbgBpAG4AZwAvAE0AcwBQAGUAYQBwAEMAbwBuAG4AZQBjAHQAaQBvAG4AUAByAG8AcABlAHIAdABpAGUAcwBWADEAIgA+ADwAUwBlAHIAdgBlAHIAVgBhAGwAaQBkAGEAdABpAG8AbgA+ADwARABpAHMAYQBiAGwAZQBVAHMAZQByAFAAcgBvAG0AcAB0AEYAbwByAFMAZQByAHYAZQByAFYAYQBsAGkAZABhAHQAaQBvAG4APgBmAGEAbABzAGUAPAAvAEQAaQBzAGEAYgBsAGUAVQBzAGUAcgBQAHIAbwBtAHAAdABGAG8AcgBTAGUAcgB2AGUAcgBWAGEAbABpAGQAYQB0AGkAbwBuAD4APABTAGUAcgB2AGUAcgBOAGEAbQBlAHMAPgA8AC8AUwBlAHIAdgBlAHIATgBhAG0AZQBzAD4APABUAHIAdQBzAHQAZQBkAFIAbwBvAHQAQwBBAD4AZAAxACAAZQBiACAAMgAzACAAYQA0ACAANgBkACAAMQA3ACAAZAA2ACAAOABmACAAZAA5ACAAMgA1ACAANgA0ACAAYwAyACAAZgAxACAAZgAxACAANgAwACAAMQA3ACAANgA0ACAAZAA4ACAAZQAzACAANAA5ACAAPAAvAFQAcgB1AHMAdABlAGQAUgBvAG8AdABDAEEAPgA8AFQAcgB1AHMAdABlAGQAUgBvAG8AdABDAEEAPgAwADIAIABmAGEAIABmADMAIABlADIAIAA5ADEAIAA0ADMAIAA1ADQAIAA2ADgAIAA2ADAAIAA3ADgAIAA1ADcAIAA2ADkAIAA0AGQAIABmADUAIABlADQAIAA1AGIAIAA2ADgAIAA4ADUAIAAxADgAIAA2ADgAIAA8AC8AVAByAHUAcwB0AGUAZABSAG8AbwB0AEMAQQA+ADwAVAByAHUAcwB0AGUAZABSAG8AbwB0AEMAQQA+ADIAYgAgADgAZgAgADEAYgAgADUANwAgADMAMwAgADAAZAAgAGIAYgAgAGEAMgAgAGQAMAAgADcAYQAgADYAYwAgADUAMQAgAGYANwAgADAAZQAgAGUAOQAgADAAZAAgAGQAYQAgAGIAOQAgAGEAZAAgADgAZQAgADwALwBUAHIAdQBzAHQAZQBkAFIAbwBvAHQAQwBBAD4APAAvAFMAZQByAHYAZQByAFYAYQBsAGkAZABhAHQAaQBvAG4APgA8AEYAYQBzAHQAUgBlAGMAbwBuAG4AZQBjAHQAPgB0AHIAdQBlADwALwBGAGEAcwB0AFIAZQBjAG8AbgBuAGUAYwB0AD4APABJAG4AbgBlAHIARQBhAHAATwBwAHQAaQBvAG4AYQBsAD4AZgBhAGwAcwBlADwALwBJAG4AbgBlAHIARQBhAHAATwBwAHQAaQBvAG4AYQBsAD4APABFAGEAcAAgAHgAbQBsAG4AcwA9ACIAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAG0AaQBjAHIAbwBzAG8AZgB0AC4AYwBvAG0ALwBwAHIAbwB2AGkAcwBpAG8AbgBpAG4AZwAvAEIAYQBzAGUARQBhAHAAQwBvAG4AbgBlAGMAdABpAG8AbgBQAHIAbwBwAGUAcgB0AGkAZQBzAFYAMQAiAD4APABUAHkAcABlAD4AMgA2ADwALwBUAHkAcABlAD4APABFAGEAcABUAHkAcABlACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHcAdwB3AC4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQAvAHAAcgBvAHYAaQBzAGkAbwBuAGkAbgBnAC8ATQBzAEMAaABhAHAAVgAyAEMAbwBuAG4AZQBjAHQAaQBvAG4AUAByAG8AcABlAHIAdABpAGUAcwBWADEAIgA+ADwAVQBzAGUAVwBpAG4ATABvAGcAbwBuAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwA+AHQAcgB1AGUAPAAvAFUAcwBlAFcAaQBuAEwAbwBnAG8AbgBDAHIAZQBkAGUAbgB0AGkAYQBsAHMAPgA8AC8ARQBhAHAAVAB5AHAAZQA+ADwALwBFAGEAcAA+ADwARQBuAGEAYgBsAGUAUQB1AGEAcgBhAG4AdABpAG4AZQBDAGgAZQBjAGsAcwA+AGYAYQBsAHMAZQA8AC8ARQBuAGEAYgBsAGUAUQB1AGEAcgBhAG4AdABpAG4AZQBDAGgAZQBjAGsAcwA+ADwAUgBlAHEAdQBpAHIAZQBDAHIAeQBwAHQAbwBCAGkAbgBkAGkAbgBnAD4AZgBhAGwAcwBlADwALwBSAGUAcQB1AGkAcgBlAEMAcgB5AHAAdABvAEIAaQBuAGQAaQBuAGcAPgA8AFAAZQBhAHAARQB4AHQAZQBuAHMAaQBvAG4AcwA+ADwAUABlAHIAZgBvAHIAbQBTAGUAcgB2AGUAcgBWAGEAbABpAGQAYQB0AGkAbwBuACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHcAdwB3AC4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQAvAHAAcgBvAHYAaQBzAGkAbwBuAGkAbgBnAC8ATQBzAFAAZQBhAHAAQwBvAG4AbgBlAGMAdABpAG8AbgBQAHIAbwBwAGUAcgB0AGkAZQBzAFYAMgAiAD4AdAByAHUAZQA8AC8AUABlAHIAZgBvAHIAbQBTAGUAcgB2AGUAcgBWAGEAbABpAGQAYQB0AGkAbwBuAD4APABBAGMAYwBlAHAAdABTAGUAcgB2AGUAcgBOAGEAbQBlACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHcAdwB3AC4AbQBpAGMAcgBvAHMAbwBmAHQALgBjAG8AbQAvAHAAcgBvAHYAaQBzAGkAbwBuAGkAbgBnAC8ATQBzAFAAZQBhAHAAQwBvAG4AbgBlAGMAdABpAG8AbgBQAHIAbwBwAGUAcgB0AGkAZQBzAFYAMgAiAD4AZgBhAGwAcwBlADwALwBBAGMAYwBlAHAAdABTAGUAcgB2AGUAcgBOAGEAbQBlAD4APAAvAFAAZQBhAHAARQB4AHQAZQBuAHMAaQBvAG4AcwA+ADwALwBFAGEAcABUAHkAcABlAD4APAAvAEUAYQBwAD4APAAvAEMAbwBuAGYAaQBnAD4APAAvAEUAYQBwAEgAbwBzAHQAQwBvAG4AZgBpAGcAPgA8AC8ARQBBAFAAQwBvAG4AZgBpAGcAPgAKAAkACQAJADwALwBPAG4AZQBYAD4ACgAJAAkAPAAvAHMAZQBjAHUAcgBpAHQAeQA+AAoACQA8AC8ATQBTAE0APgAKADwALwBMAEEATgBQAHIAbwBmAGkAbABlAD4A"
    $DecodedText = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedText))
    Set-Content -Path "c:\temp\lan.xml" -Value $DecodedText
    }

#Import LAN Profile to all LAN interfaces
netsh lan add profile filename="C:\temp\lan.xml" interface=*

#Force all interfaces to reconnect
netsh lan reconnect interface=*
  
#Pause the script for 30 seconds to allow the adapter to Auth
ping localhost -n 5

#Show the interface to see the status and show profiles to see which profile is applied.
netsh lan show interfaces
netsh lan show profiles
netsh wlan show profiles

#generate VPN and ISE Profile
Remove-Item "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile\DefaultProfile.xml"
Remove-Item "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture\ISEPostureCFG.xml"

if (Test-Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture") {}
else {mkdir "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture"}

if (Test-Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile") {}
else {mkdir "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile"}

if (Test-Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile\DefaultProfile.xml"){}
else {
        New-Item -ItemType File -Name "DefaultProfile.xml" -Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile\DefaultProfile.xml"
     $EncodedText = "PAA/AHgAbQBsACAAdgBlAHIAcwBpAG8AbgA9ACIAMQAuADAAIgAgAGUAbgBjAG8AZABpAG4AZwA9ACIAVQBUAEYALQA4ACIAPwA+AAoAPABBAG4AeQBDAG8AbgBuAGUAYwB0AFAAcgBvAGYAaQBsAGUAIAB4AG0AbABuAHMAPQAiAGgAdAB0AHAAOgAvAC8AcwBjAGgAZQBtAGEAcwAuAHgAbQBsAHMAbwBhAHAALgBvAHIAZwAvAGUAbgBjAG8AZABpAG4AZwAvACIAIAB4AG0AbABuAHMAOgB4AHMAaQA9ACIAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAHcAMwAuAG8AcgBnAC8AMgAwADAAMQAvAFgATQBMAFMAYwBoAGUAbQBhAC0AaQBuAHMAdABhAG4AYwBlACIAIAB4AHMAaQA6AHMAYwBoAGUAbQBhAEwAbwBjAGEAdABpAG8AbgA9ACIAaAB0AHQAcAA6AC8ALwBzAGMAaABlAG0AYQBzAC4AeABtAGwAcwBvAGEAcAAuAG8AcgBnAC8AZQBuAGMAbwBkAGkAbgBnAC8AIABBAG4AeQBDAG8AbgBuAGUAYwB0AFAAcgBvAGYAaQBsAGUALgB4AHMAZAAiAD4ACgAJADwAQwBsAGkAZQBuAHQASQBuAGkAdABpAGEAbABpAHoAYQB0AGkAbwBuAD4ACgAJAAkAPABVAHMAZQBTAHQAYQByAHQAQgBlAGYAbwByAGUATABvAGcAbwBuACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAdAByAHUAZQAiAD4AZgBhAGwAcwBlADwALwBVAHMAZQBTAHQAYQByAHQAQgBlAGYAbwByAGUATABvAGcAbwBuAD4ACgAJAAkAPABBAHUAdABvAG0AYQB0AGkAYwBDAGUAcgB0AFMAZQBsAGUAYwB0AGkAbwBuACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAdAByAHUAZQAiAD4AZgBhAGwAcwBlADwALwBBAHUAdABvAG0AYQB0AGkAYwBDAGUAcgB0AFMAZQBsAGUAYwB0AGkAbwBuAD4ACgAJAAkAPABTAGgAbwB3AFAAcgBlAEMAbwBuAG4AZQBjAHQATQBlAHMAcwBhAGcAZQA+AGYAYQBsAHMAZQA8AC8AUwBoAG8AdwBQAHIAZQBDAG8AbgBuAGUAYwB0AE0AZQBzAHMAYQBnAGUAPgAKAAkACQA8AEMAZQByAHQAaQBmAGkAYwBhAHQAZQBTAHQAbwByAGUAPgBBAGwAbAA8AC8AQwBlAHIAdABpAGYAaQBjAGEAdABlAFMAdABvAHIAZQA+AAoACQAJADwAQwBlAHIAdABpAGYAaQBjAGEAdABlAFMAdABvAHIAZQBNAGEAYwA+AEEAbABsADwALwBDAGUAcgB0AGkAZgBpAGMAYQB0AGUAUwB0AG8AcgBlAE0AYQBjAD4ACgAJAAkAPABDAGUAcgB0AGkAZgBpAGMAYQB0AGUAUwB0AG8AcgBlAE8AdgBlAHIAcgBpAGQAZQA+AGYAYQBsAHMAZQA8AC8AQwBlAHIAdABpAGYAaQBjAGEAdABlAFMAdABvAHIAZQBPAHYAZQByAHIAaQBkAGUAPgAKAAkACQA8AFAAcgBvAHgAeQBTAGUAdAB0AGkAbgBnAHMAPgBOAGEAdABpAHYAZQA8AC8AUAByAG8AeAB5AFMAZQB0AHQAaQBuAGcAcwA+AAoACQAJADwAQQBsAGwAbwB3AEwAbwBjAGEAbABQAHIAbwB4AHkAQwBvAG4AbgBlAGMAdABpAG8AbgBzAD4AdAByAHUAZQA8AC8AQQBsAGwAbwB3AEwAbwBjAGEAbABQAHIAbwB4AHkAQwBvAG4AbgBlAGMAdABpAG8AbgBzAD4ACgAJAAkAPABBAHUAdABoAGUAbgB0AGkAYwBhAHQAaQBvAG4AVABpAG0AZQBvAHUAdAA+ADYAMAA8AC8AQQB1AHQAaABlAG4AdABpAGMAYQB0AGkAbwBuAFQAaQBtAGUAbwB1AHQAPgAKAAkACQA8AEEAdQB0AG8AQwBvAG4AbgBlAGMAdABPAG4AUwB0AGEAcgB0ACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAdAByAHUAZQAiAD4AZgBhAGwAcwBlADwALwBBAHUAdABvAEMAbwBuAG4AZQBjAHQATwBuAFMAdABhAHIAdAA+AAoACQAJADwATQBpAG4AaQBtAGkAegBlAE8AbgBDAG8AbgBuAGUAYwB0ACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAdAByAHUAZQAiAD4AdAByAHUAZQA8AC8ATQBpAG4AaQBtAGkAegBlAE8AbgBDAG8AbgBuAGUAYwB0AD4ACgAJAAkAPABMAG8AYwBhAGwATABhAG4AQQBjAGMAZQBzAHMAIABVAHMAZQByAEMAbwBuAHQAcgBvAGwAbABhAGIAbABlAD0AIgB0AHIAdQBlACIAPgB0AHIAdQBlADwALwBMAG8AYwBhAGwATABhAG4AQQBjAGMAZQBzAHMAPgAKAAkACQA8AEQAaQBzAGEAYgBsAGUAQwBhAHAAdABpAHYAZQBQAG8AcgB0AGEAbABEAGUAdABlAGMAdABpAG8AbgAgAFUAcwBlAHIAQwBvAG4AdAByAG8AbABsAGEAYgBsAGUAPQAiAHQAcgB1AGUAIgA+AGYAYQBsAHMAZQA8AC8ARABpAHMAYQBiAGwAZQBDAGEAcAB0AGkAdgBlAFAAbwByAHQAYQBsAEQAZQB0AGUAYwB0AGkAbwBuAD4ACgAJAAkAPABDAGwAZQBhAHIAUwBtAGEAcgB0AGMAYQByAGQAUABpAG4AIABVAHMAZQByAEMAbwBuAHQAcgBvAGwAbABhAGIAbABlAD0AIgB0AHIAdQBlACIAPgB0AHIAdQBlADwALwBDAGwAZQBhAHIAUwBtAGEAcgB0AGMAYQByAGQAUABpAG4APgAKAAkACQA8AEkAUABQAHIAbwB0AG8AYwBvAGwAUwB1AHAAcABvAHIAdAA+AEkAUAB2ADQALABJAFAAdgA2ADwALwBJAFAAUAByAG8AdABvAGMAbwBsAFMAdQBwAHAAbwByAHQAPgAKAAkACQA8AEEAdQB0AG8AUgBlAGMAbwBuAG4AZQBjAHQAIABVAHMAZQByAEMAbwBuAHQAcgBvAGwAbABhAGIAbABlAD0AIgBmAGEAbABzAGUAIgA+AHQAcgB1AGUACgAJAAkACQA8AEEAdQB0AG8AUgBlAGMAbwBuAG4AZQBjAHQAQgBlAGgAYQB2AGkAbwByACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAZgBhAGwAcwBlACIAPgBEAGkAcwBjAG8AbgBuAGUAYwB0AE8AbgBTAHUAcwBwAGUAbgBkADwALwBBAHUAdABvAFIAZQBjAG8AbgBuAGUAYwB0AEIAZQBoAGEAdgBpAG8AcgA+AAoACQAJADwALwBBAHUAdABvAFIAZQBjAG8AbgBuAGUAYwB0AD4ACgAJAAkAPABBAHUAdABvAFUAcABkAGEAdABlACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAZgBhAGwAcwBlACIAPgB0AHIAdQBlADwALwBBAHUAdABvAFUAcABkAGEAdABlAD4ACgAJAAkAPABSAFMAQQBTAGUAYwB1AHIASQBEAEkAbgB0AGUAZwByAGEAdABpAG8AbgAgAFUAcwBlAHIAQwBvAG4AdAByAG8AbABsAGEAYgBsAGUAPQAiAGYAYQBsAHMAZQAiAD4AQQB1AHQAbwBtAGEAdABpAGMAPAAvAFIAUwBBAFMAZQBjAHUAcgBJAEQASQBuAHQAZQBnAHIAYQB0AGkAbwBuAD4ACgAJAAkAPABXAGkAbgBkAG8AdwBzAEwAbwBnAG8AbgBFAG4AZgBvAHIAYwBlAG0AZQBuAHQAPgBTAGkAbgBnAGwAZQBMAG8AYwBhAGwATABvAGcAbwBuADwALwBXAGkAbgBkAG8AdwBzAEwAbwBnAG8AbgBFAG4AZgBvAHIAYwBlAG0AZQBuAHQAPgAKAAkACQA8AFcAaQBuAGQAbwB3AHMAVgBQAE4ARQBzAHQAYQBiAGwAaQBzAGgAbQBlAG4AdAA+AEwAbwBjAGEAbABVAHMAZQByAHMATwBuAGwAeQA8AC8AVwBpAG4AZABvAHcAcwBWAFAATgBFAHMAdABhAGIAbABpAHMAaABtAGUAbgB0AD4ACgAJAAkAPABBAHUAdABvAG0AYQB0AGkAYwBWAFAATgBQAG8AbABpAGMAeQA+AGYAYQBsAHMAZQA8AC8AQQB1AHQAbwBtAGEAdABpAGMAVgBQAE4AUABvAGwAaQBjAHkAPgAKAAkACQA8AFAAUABQAEUAeABjAGwAdQBzAGkAbwBuACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAZgBhAGwAcwBlACIAPgBEAGkAcwBhAGIAbABlAAoACQAJAAkAPABQAFAAUABFAHgAYwBsAHUAcwBpAG8AbgBTAGUAcgB2AGUAcgBJAFAAIABVAHMAZQByAEMAbwBuAHQAcgBvAGwAbABhAGIAbABlAD0AIgBmAGEAbABzAGUAIgA+ADwALwBQAFAAUABFAHgAYwBsAHUAcwBpAG8AbgBTAGUAcgB2AGUAcgBJAFAAPgAKAAkACQA8AC8AUABQAFAARQB4AGMAbAB1AHMAaQBvAG4APgAKAAkACQA8AEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AGkAbgBnACAAVQBzAGUAcgBDAG8AbgB0AHIAbwBsAGwAYQBiAGwAZQA9ACIAZgBhAGwAcwBlACIAPgBmAGEAbABzAGUAPAAvAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AGkAbgBnAD4ACgAJAAkAPABFAG4AYQBiAGwAZQBBAHUAdABvAG0AYQB0AGkAYwBTAGUAcgB2AGUAcgBTAGUAbABlAGMAdABpAG8AbgAgAFUAcwBlAHIAQwBvAG4AdAByAG8AbABsAGEAYgBsAGUAPQAiAGYAYQBsAHMAZQAiAD4AZgBhAGwAcwBlAAoACQAJAAkAPABBAHUAdABvAFMAZQByAHYAZQByAFMAZQBsAGUAYwB0AGkAbwBuAEkAbQBwAHIAbwB2AGUAbQBlAG4AdAA+ADIAMAA8AC8AQQB1AHQAbwBTAGUAcgB2AGUAcgBTAGUAbABlAGMAdABpAG8AbgBJAG0AcAByAG8AdgBlAG0AZQBuAHQAPgAKAAkACQAJADwAQQB1AHQAbwBTAGUAcgB2AGUAcgBTAGUAbABlAGMAdABpAG8AbgBTAHUAcwBwAGUAbgBkAFQAaQBtAGUAPgA0ADwALwBBAHUAdABvAFMAZQByAHYAZQByAFMAZQBsAGUAYwB0AGkAbwBuAFMAdQBzAHAAZQBuAGQAVABpAG0AZQA+AAoACQAJADwALwBFAG4AYQBiAGwAZQBBAHUAdABvAG0AYQB0AGkAYwBTAGUAcgB2AGUAcgBTAGUAbABlAGMAdABpAG8AbgA+AAoACQAJADwAUgBlAHQAYQBpAG4AVgBwAG4ATwBuAEwAbwBnAG8AZgBmAD4AZgBhAGwAcwBlAAoACQAJADwALwBSAGUAdABhAGkAbgBWAHAAbgBPAG4ATABvAGcAbwBmAGYAPgAKAAkACQA8AEEAbABsAG8AdwBNAGEAbgB1AGEAbABIAG8AcwB0AEkAbgBwAHUAdAA+AHQAcgB1AGUAPAAvAEEAbABsAG8AdwBNAGEAbgB1AGEAbABIAG8AcwB0AEkAbgBwAHUAdAA+AAoACQA8AC8AQwBsAGkAZQBuAHQASQBuAGkAdABpAGEAbABpAHoAYQB0AGkAbwBuAD4ACgAJADwAUwBlAHIAdgBlAHIATABpAHMAdAA+AAoACQAJADwASABvAHMAdABFAG4AdAByAHkAPgAKAAkACQAJADwASABvAHMAdABOAGEAbQBlAD4AQQBiAHUAIABEAGgAYQBiAGkAPAAvAEgAbwBzAHQATgBhAG0AZQA+AAoACQAJAAkAPABIAG8AcwB0AEEAZABkAHIAZQBzAHMAPgB2AHAAbgAuAGEAYgB1AGQAaABhAGIAaQAuAG4AeQB1AC4AZQBkAHUAPAAvAEgAbwBzAHQAQQBkAGQAcgBlAHMAcwA+AAoACQAJADwALwBIAG8AcwB0AEUAbgB0AHIAeQA+AAoACQAJADwASABvAHMAdABFAG4AdAByAHkAPgAKAAkACQAJADwASABvAHMAdABOAGEAbQBlAD4ATgBlAHcAIABZAG8AcgBrADwALwBIAG8AcwB0AE4AYQBtAGUAPgAKAAkACQAJADwASABvAHMAdABBAGQAZAByAGUAcwBzAD4AdgBwAG4ALgBuAHkAdQAuAGUAZAB1ADwALwBIAG8AcwB0AEEAZABkAHIAZQBzAHMAPgAKAAkACQA8AC8ASABvAHMAdABFAG4AdAByAHkAPgAKAAkACQA8AEgAbwBzAHQARQBuAHQAcgB5AD4ACgAJAAkACQA8AEgAbwBzAHQATgBhAG0AZQA+AFMAaABhAG4AZwBoAGEAaQA8AC8ASABvAHMAdABOAGEAbQBlAD4ACgAJAAkACQA8AEgAbwBzAHQAQQBkAGQAcgBlAHMAcwA+AHYAcABuAC0AYwB0AC4AcwBoAGEAbgBnAGgAYQBpAC4AbgB5AHUALgBlAGQAdQA8AC8ASABvAHMAdABBAGQAZAByAGUAcwBzAD4ACgAJAAkAPAAvAEgAbwBzAHQARQBuAHQAcgB5AD4ACgAJADwALwBTAGUAcgB2AGUAcgBMAGkAcwB0AD4ACgA8AC8AQQBuAHkAQwBvAG4AbgBlAGMAdABQAHIAbwBmAGkAbABlAD4ACgA="
     $DecodedText = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedText))
    Set-Content -Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\Profile\DefaultProfile.xml" -Value $DecodedText
    }

    if (Test-Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture\ISEPostureCFG.xml"){}
else {
    New-Item -ItemType File -Name "ISEPostureCFG.xml" -Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture\ISEPostureCFG.xml"
     $EncodedText = "PAA/AHgAbQBsACAAdgBlAHIAcwBpAG8AbgA9ACIAMQAuADAAIgAgAGUAbgBjAG8AZABpAG4AZwA9ACIAVQBUAEYALQA4ACIAPwA+AAoAPABjAGYAZwAKAAkAeABtAGwAbgBzADoAeABzAGkAPQAnAGgAdAB0AHAAOgAvAC8AdwB3AHcALgB3ADMALgBvAHIAZwAvADIAMAAwADEALwBYAE0ATABTAGMAaABlAG0AYQAtAGkAbgBzAHQAYQBuAGMAZQAnAAoACQB4AG0AbABuAHMAPQAnAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBjAGkAcwBjAG8ALgBjAG8AbQAvAG4AYQBjAC8AYQBnAGUAbgB0AC8AYwBvAG4AZgBpAGcALQAxAC4AMAAnAAoACQB4AHMAaQA6AHMAYwBoAGUAbQBhAEwAbwBjAGEAdABpAG8AbgA9ACcAaAB0AHQAcAA6AC8ALwB3AHcAdwAuAGMAaQBzAGMAbwAuAGMAbwBtAC8AbgBhAGMALwBhAGcAZQBuAHQALwBjAG8AbgBmAGkAZwAtADEALgAwACAASQBTAEUAUABvAHMAdAB1AHIAZQBDAEYARwAuAHgAcwBkACcAPgAKAAkAPABjAG8AbgBmAGkAZwBOAGEAbQBlAD4AaQBzAGUALQBwAG8AcwB0AHUAcgBlAC0AcAByAG8AZgBpAGwAZQAuAHgAbQBsADwALwBjAG8AbgBmAGkAZwBOAGEAbQBlAD4ACgAJADwATgBhAGMAQQBuAHkAQwBvAG4AbgBlAGMAdABEAHIAcABEAG8AdwBuAD4AQQBuAHkAQwBvAG4AbgBlAGMAdABBAGcAZQBuAHQAPAAvAE4AYQBjAEEAbgB5AEMAbwBuAG4AZQBjAHQARAByAHAARABvAHcAbgA+AAoACQA8AE8AcABlAHIAYQB0AGUATwBuAE4AbwBuAEQAbwB0ADEAWABXAGkAcgBlAGwAZQBzAHMAPgAwADwALwBPAHAAZQByAGEAdABlAE8AbgBOAG8AbgBEAG8AdAAxAFgAVwBpAHIAZQBsAGUAcwBzAD4ACgAJADwAQgBhAGMAawBPAGYAZgBUAGkAbQBlAHIATABpAG0AaQB0AD4AMwAwADwALwBCAGEAYwBrAE8AZgBmAFQAaQBtAGUAcgBMAGkAbQBpAHQAPgAKAAkAPABMAG8AZwBUAHIAYQBjAGUAPgAwADwALwBMAG8AZwBUAHIAYQBjAGUAPgAKAAkAPABSAGUAbQBlAGQAaQBhAHQAaQBvAG4AVABpAG0AZQByAD4AMgAwADwALwBSAGUAbQBlAGQAaQBhAHQAaQBvAG4AVABpAG0AZQByAD4ACgAJADwARABoAGMAcABSAGUAbgBlAHcARABlAGwAYQB5AD4AMQA8AC8ARABoAGMAcABSAGUAbgBlAHcARABlAGwAYQB5AD4ACgAJADwAQwBhAGwAbABIAG8AbQBlAEwAaQBzAHQAPgBuAGEAYwAtAGkAcwBlADEALgBhAGIAdQBkAGgAYQBiAGkALgBuAHkAdQAuAGUAZAB1ACwAbgBhAGMALQBpAHMAZQAyAC4AYQBiAHUAZABoAGEAYgBpAC4AbgB5AHUALgBlAGQAdQA8AC8AQwBhAGwAbABIAG8AbQBlAEwAaQBzAHQAPgAKAAkAPABMAG8AZwBGAGkAbABlAFMAaQB6AGUAPgA1ADwALwBMAG8AZwBGAGkAbABlAFMAaQB6AGUAPgAKAAkAPABQAFIAQQBSAGUAdAByAGEAbgBzAG0AaQBzAHMAaQBvAG4AVABpAG0AZQA+ADEAMgAwADwALwBQAFIAQQBSAGUAdAByAGEAbgBzAG0AaQBzAHMAaQBvAG4AVABpAG0AZQA+AAoACQA8AEUAbgBhAGIAbABlAEEAZwBlAG4AdABJAHAAUgBlAGYAcgBlAHMAaAA+ADEAPAAvAEUAbgBhAGIAbABlAEEAZwBlAG4AdABJAHAAUgBlAGYAcgBlAHMAaAA+AAoACQA8AE4AZQB0AHcAbwByAGsAVAByAGEAbgBzAGkAdABpAG8AbgBEAGUAbABhAHkAPgAzADwALwBOAGUAdAB3AG8AcgBrAFQAcgBhAG4AcwBpAHQAaQBvAG4ARABlAGwAYQB5AD4ACgAJADwAUABpAG4AZwBBAHIAcAA+ADAAPAAvAFAAaQBuAGcAQQByAHAAPgAKAAkAPABQAGkAbgBnAE0AYQB4AFQAaQBtAGUAbwB1AHQAPgAxADwALwBQAGkAbgBnAE0AYQB4AFQAaQBtAGUAbwB1AHQAPgAKAAkAPABEAGgAYwBwAFIAZQBsAGUAYQBzAGUARABlAGwAYQB5AD4ANAA8AC8ARABoAGMAcABSAGUAbABlAGEAcwBlAEQAZQBsAGEAeQA+AAoACQA8AFMAdABlAGEAbAB0AGgAVwBpAHQAaABOAG8AdABpAGYAaQBjAGEAdABpAG8AbgA+ADAAPAAvAFMAdABlAGEAbAB0AGgAVwBpAHQAaABOAG8AdABpAGYAaQBjAGEAdABpAG8AbgA+AAoACQA8AFMAaQBnAG4AYQB0AHUAcgBlAEMAaABlAGMAawA+ADAAPAAvAFMAaQBnAG4AYQB0AHUAcgBlAEMAaABlAGMAawA+AAoACQA8AFMAdABlAGEAbAB0AGgATQBvAGQAZQA+ADEAPAAvAFMAdABlAGEAbAB0AGgATQBvAGQAZQA+AAoACQA8AEUAbgBhAGIAbABlAFIAZQBzAGMAYQBuAEIAdQB0AHQAbwBuAD4AMAA8AC8ARQBuAGEAYgBsAGUAUgBlAHMAYwBhAG4AQgB1AHQAdABvAG4APgAKAAkAPABWAGwAYQBuAEQAZQB0AGUAYwB0AEkAbgB0AGUAcgB2AGEAbAA+ADAAPAAvAFYAbABhAG4ARABlAHQAZQBjAHQASQBuAHQAZQByAHYAYQBsAD4ACgAJADwARABpAHMAYQBiAGwAZQBVAEEAQwA+ADEAPAAvAEQAaQBzAGEAYgBsAGUAVQBBAEMAPgAKAAkAPABTAGUAcgB2AGUAcgBOAGEAbQBlAFIAdQBsAGUAcwA+ACoAPAAvAFMAZQByAHYAZQByAE4AYQBtAGUAUgB1AGwAZQBzAD4ACgAJADwAUABlAHIAaQBvAGQAaQBjAFAAcgBvAGIAaQBuAGcAPgAzADwALwBQAGUAcgBpAG8AZABpAGMAUAByAG8AYgBpAG4AZwA+AAoAPAAvAGMAZgBnAD4A"
     $DecodedText = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedText))
    Set-Content -Path "C:\ProgramData\Cisco\Cisco AnyConnect Secure Mobility Client\ISE Posture\ISEPostureCFG.xml" -Value $DecodedText
    }
    
